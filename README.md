# Payment GoLang

## Установка
Для работы с проектом требуется установить go версии `1.20` (актуальная всегда в go.mod).

```shell
# установка
$ sudo wget https://dl.google.com/go/go1.20.4.linux-amd64.tar.gz
$ sudo rm -rf /usr/local/go && sudo tar -C /usr/local -xzf go1.20.4.linux-amd64.tar.gz
$ sudo export PATH=$PATH:/usr/local/go/bin
```
```shell
# проверка
$ go version
```

Опционально можно установить утилиту `make` для запуска шорткатов из Makefile.
Команды для запуска/компиляции ниже будут использовать make.
```shell
# установка
$ sudo apt update
$ sudo apt install make
```
```shell
# проверка
$ make --version
```

## Build and Run
Сначала надо подтянуть все зависимости:
```shell
$ go mod download
```
Для компиляции использовать:
```shell
# на Windows
$ make build-windows
```
```shell
# на Linux
$ make build-linux
```
```shell
# на Debian
$ make build-debian
```
Для компиляции и запуска использовать:
```shell
# на Windows
$ make run-windows
```
```shell
# на Linux
$ make run-linux
```
```shell
# на Debian
$ make run-debian
```
Сначала соберётся нужный бинарник, потом сразу же сам запустится.
Бинарные файлы попадают в папку build.

> Более детально ознакомиться с командами можно в самом Makefile

> Миграции БД происходят автоматически при запуске приложения через gorm.DB.AutoMigrate

## Структура проекта
- **build** - скомпилированные бинарники
- **cmd** - точки входа в приложение
- **configs** - файлы конфигураций
- **docs** - полезная информация
  - **bank_api** - примеры ответов от банка
- **internal** - основная директория приложения
  - **app** - приложение
  - **config** - конфигурация
  - **controllers** - контроллеры
  - **database** - БД
  - **models** - модели
  - **providers** - провайдеры
  - **repositories** - репозитории
  - **services** - сервисы
  - **transport**
    - **bank_api** - DTO для работы с банком
    - **model** - DTO моделей
  - **utils** - утилиты
- **tests** - тесты


## Конфигурация

### Расположение конфигурационных файлов

Конфигурационные файлы ищутся относительно
рабочей директории по следующим путям:
```
1. ./
2. ./configs/
3. ../configs/
```

### Конфигурация прокси
Конфигурация прокси и UserAgent'ов должна присутствовать
в конфигурационном файле `proxy.json`.

### ENV-переменные
Приоритет при поиске env-переменных:
```
1. окружение
2. local.env (создаётся вручную, для локального запуска)
2. .env (создаётся вручную)
```

### Список ENV-переменных
- **DEV_MODE** - указывать только для dev 
(*для активации указать `1` или `true`*)
- **APP_PORT** - порт для запуска (например `8001`)
- **DB_TYPE** - тип БД (на данный момент только mysql)
- **DB_HOST** - хост БД
- **DB_PORT** - порт БД
- **DB_NAME** - имя БД
- **DB_USER** - пользователь БД
- **DB_PASSWORD** - пароль пользователя БД


